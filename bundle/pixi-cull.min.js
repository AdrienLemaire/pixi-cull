!function r(a,n,s){function h(e,t){if(!n[e]){if(!a[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(l)return l(e,!0);throw(i=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",i}i=n[e]={exports:{}},a[e][0].call(i.exports,function(t){return h(a[e][1][t]||t)},i,i.exports,r,a,n,s)}return n[e].exports}for(var l="function"==typeof require&&require,t=0;t<s.length;t++)h(s[t]);return h}({1:[function(t,e,i){"use strict";e.exports={Simple:t("./simple"),SpatialHash:t("./spatial-hash")}},{"./simple":2,"./spatial-hash":3}],2:[function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=(function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}(n,[{key:"addList",value:function(t,e){if(this.lists.push(t),e&&(t.staticObject=!0),this.calculatePIXI&&this.dirtyTest){var i=!0,r=!1,e=void 0;try{for(var a,n=t[Symbol.iterator]();!(i=(a=n.next()).done);i=!0){var s=a.value;this.updateObject(s)}}catch(t){r=!0,e=t}finally{try{!i&&n.return&&n.return()}finally{if(r)throw e}}}return t}},{key:"removeList",value:function(t){return this.lists.splice(this.lists.indexOf(t),1),t}},{key:"add",value:function(t,e){return e&&(t.staticObject=!0),this.calculatePIXI&&(this.dirtyTest||e)&&this.updateObject(t),this.lists[0].push(t),t}},{key:"remove",value:function(t){return this.lists[0].splice(this.lists[0].indexOf(t),1),t}},{key:"cull",value:function(t,e){this.calculatePIXI&&!e&&this.updateObjects();var i=!0,r=!1,e=void 0;try{for(var a,n=this.lists[Symbol.iterator]();!(i=(a=n.next()).done);i=!0){var s=a.value,h=!0,l=!1,o=void 0;try{for(var u,c=s[Symbol.iterator]();!(h=(u=c.next()).done);h=!0){var y=u.value,v=y[this.AABB];y[this.visible]=v.x+v.width>t.x&&v.x<t.x+t.width&&v.y+v.height>t.y&&v.y<t.y+t.height}}catch(t){l=!0,o=t}finally{try{!h&&c.return&&c.return()}finally{if(l)throw o}}}}catch(t){r=!0,e=t}finally{try{!i&&n.return&&n.return()}finally{if(r)throw e}}}},{key:"updateObjects",value:function(){if(this.dirtyTest){var t=!0,e=!1,i=void 0;try{for(var r,a=this.lists[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var n=r.value;if(!n.staticObject){var s=!0,h=!1,l=void 0;try{for(var o,u=n[Symbol.iterator]();!(s=(o=u.next()).done);s=!0){var c=o.value;!c.staticObject&&c[this.dirty]&&(this.updateObject(c),c[this.dirty]=!1)}}catch(t){h=!0,l=t}finally{try{!s&&u.return&&u.return()}finally{if(h)throw l}}}}}catch(t){e=!0,i=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}}else{var y=!0,e=!1,i=void 0;try{for(var v,f=this.lists[Symbol.iterator]();!(y=(v=f.next()).done);y=!0){var d=v.value;if(!d.staticObject){var x=!0,b=!1,p=void 0;try{for(var g,m=d[Symbol.iterator]();!(x=(g=m.next()).done);x=!0){var B=g.value;B.staticObject||this.updateObject(B)}}catch(t){b=!0,p=t}finally{try{!x&&m.return&&m.return()}finally{if(b)throw p}}}}}catch(t){e=!0,i=t}finally{try{!y&&f.return&&f.return()}finally{if(e)throw i}}}}},{key:"updateObject",value:function(t){var e=t.getLocalBounds();t[this.AABB]=t[this.AABB]||{},t[this.AABB].x=t.x+(e.x-t.pivot.x)*t.scale.x,t[this.AABB].y=t.y+(e.y-t.pivot.y)*t.scale.y,t[this.AABB].width=e.width*t.scale.x,t[this.AABB].height=e.height*t.scale.y}},{key:"query",value:function(t){var e=[],i=!0,r=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(i=(n=s.next()).done);i=!0){var h=n.value,l=!0,o=!1,u=void 0;try{for(var c,y=h[Symbol.iterator]();!(l=(c=y.next()).done);l=!0){var v=c.value,f=v[this.AABB];f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&e.push(v)}}catch(t){o=!0,u=t}finally{try{!l&&y.return&&y.return()}finally{if(o)throw u}}}}catch(t){r=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return e}},{key:"queryCallback",value:function(t,e){var i=!0,r=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(i=(n=s.next()).done);i=!0){var h=n.value,l=!0,o=!1,u=void 0;try{for(var c,y=h[Symbol.iterator]();!(l=(c=y.next()).done);l=!0){var v=c.value,f=v[this.AABB];if(f.x+f.width>t.x&&f.x-f.width<t.x+t.width&&f.y+f.height>t.y&&f.y-f.height<t.y+t.height&&e(v))return!0}}catch(t){o=!0,u=t}finally{try{!l&&y.return&&y.return()}finally{if(o)throw u}}}}catch(t){r=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return!1}},{key:"stats",value:function(){var e=0,i=0,t=!0,r=!1,a=void 0;try{for(var n,s=this.lists[Symbol.iterator]();!(t=(n=s.next()).done);t=!0)n.value.forEach(function(t){e+=t.visible?1:0,i++})}catch(t){r=!0,a=t}finally{try{!t&&s.return&&s.return()}finally{if(r)throw a}}return{total:i,visible:e,culled:i-e}}}]),n);function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.visible=(t=t||{}).visible||"visible",this.calculatePIXI=void 0===t.calculatePIXI||t.calculatePIXI,this.dirtyTest=void 0===t.dirtyTest||t.dirtyTest,this.AABB=t.AABB||"AABB",this.lists=[[]]}e.exports=a},{}],3:[function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=(function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}(n,[{key:"add",value:function(t,e){t[this.spatial]={hashes:[]},this.calculatePIXI&&this.dirtyTest&&(t[this.dirty]=!0),e&&(t.staticObject=!0),this.updateObject(t),this.containers[0].push(t)}},{key:"remove",value:function(t){return this.containers[0].splice(this.list[0].indexOf(t),1),this.removeFromHash(t),t}},{key:"addContainer",value:function(t,e){var i=function(t){t[this.spatial]={hashes:[]},this.updateObject(t)}.bind(this),r=function(t){this.removeFromHash(t)}.bind(this),a=!0,n=!1,s=void 0;try{for(var h,l=t.children[Symbol.iterator]();!(a=(h=l.next()).done);a=!0){var o=h.value;o[this.spatial]={hashes:[]},this.updateObject(o)}}catch(t){n=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}t.cull={},this.containers.push(t),t.on("childAdded",i),t.on("childRemoved",r),t.cull.added=i,t.cull.removed=r,e&&(t.cull.static=!0)}},{key:"removeContainer",value:function(t){var e=this;return this.containers.splice(this.containers.indexOf(t),1),t.children.forEach(function(t){return e.removeFromHash(t)}),t.off("added",t.cull.added),t.off("removed",t.cull.removed),delete t.cull,t}},{key:"cull",value:function(t,e,i){var r=this;e||this.updateObjects(),this.invisible();return(i?this.queryCallbackAll(t,this.simpleTest,i):this.query(t,this.simpleTest)).forEach(function(t){return t[r.visible]=!0}),this.lastBuckets}},{key:"invisible",value:function(){var e=this,t=!0,i=!1,r=void 0;try{for(var a,n=this.containers[Symbol.iterator]();!(t=(a=n.next()).done);t=!0)a.value.children.forEach(function(t){return t[e.visible]=!1})}catch(t){i=!0,r=t}finally{try{!t&&n.return&&n.return()}finally{if(i)throw r}}}},{key:"updateObjects",value:function(){var e=this;if(this.dirtyTest){var t=!0,i=!1,r=void 0;try{for(var a,n=this.objects[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var s=a.value;s[this.dirty]&&(this.updateObject(s),s[this.dirty]=!1)}}catch(t){i=!0,r=t}finally{try{!t&&n.return&&n.return()}finally{if(i)throw r}}var h=!0,i=!1,r=void 0;try{for(var l,o=this.containers[Symbol.iterator]();!(h=(l=o.next()).done);h=!0){var u=l.value,c=!0,y=!1,v=void 0;try{for(var f,d=u.children[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var x=f.value;x[this.dirty]&&(this.updateObject(x),x[this.dirty]=!1)}}catch(t){y=!0,v=t}finally{try{!c&&d.return&&d.return()}finally{if(y)throw v}}}}catch(t){i=!0,r=t}finally{try{!h&&o.return&&o.return()}finally{if(i)throw r}}}else{var b=!0,i=!1,r=void 0;try{for(var p,g=this.containers[Symbol.iterator]();!(b=(p=g.next()).done);b=!0){var m=p.value;m.cull.static||m.children.forEach(function(t){return e.updateObject(t)})}}catch(t){i=!0,r=t}finally{try{!b&&g.return&&g.return()}finally{if(i)throw r}}}}},{key:"updateObject",value:function(t){var e=void 0;e=this.calculatePIXI?(r=t.getLocalBounds(),t[this.AABB]={x:t.x+(r.x-t.pivot.x)*t.scale.x,y:t.y+(r.y-t.pivot.y)*t.scale.y,width:r.width*t.scale.x,height:r.height*t.scale.y}):t[this.AABB];var i=(i=t[this.spatial])||(t[this.spatial]={hashes:[]}),r=this.getBounds(e),a=r.xStart,e=r.yStart,n=r.xEnd,s=r.yEnd;if(i.xStart!==a||i.yStart!==e||i.xEnd!==n||i.yEnd!==s){i.hashes.length&&this.removeFromHash(t);for(var h=e;h<=s;h++)for(var l=a;l<=n;l++){var o=l+","+h;this.insert(t,o),i.hashes.push(o)}i.xStart=a,i.yStart=e,i.xEnd=n,i.yEnd=s}}},{key:"getBuckets",value:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=[];for(t in this.hash){var r=this.hash[t];r.length>=e&&i.push(r)}return i}},{key:"getBounds",value:function(t){return{xStart:Math.floor(t.x/this.xSize),yStart:Math.floor(t.y/this.ySize),xEnd:Math.floor((t.x+t.width)/this.xSize),yEnd:Math.floor((t.y+t.height)/this.ySize)}}},{key:"insert",value:function(t,e){this.hash[e]?this.hash[e].push(t):this.hash[e]=[t]}},{key:"removeFromHash",value:function(t){for(var e=t[this.spatial];e.hashes.length;){var i=e.hashes.pop(),i=this.hash[i];i.splice(i.indexOf(t),1)}}},{key:"neighbors",value:function(t){var e=this,i=[];return t[this.spatial].hashes.forEach(function(t){return i=i.concat(e.hash[t])}),i}},{key:"query",value:function(t,e){e=void 0===e||e;for(var i=0,r=[],a=this.getBounds(t),n=a.xStart,s=a.yStart,h=a.xEnd,l=a.yEnd,o=s;o<=l;o++)for(var u=n;u<=h;u++){var c=this.hash[u+","+o];if(c){if(e){var y=!0,v=!1,f=void 0;try{for(var d,x=c[Symbol.iterator]();!(y=(d=x.next()).done);y=!0){var b=d.value,p=b[this.AABB];p.x+p.width>t.x&&p.x<t.x+t.width&&p.y+p.height>t.y&&p.y<t.y+t.height&&r.push(b)}}catch(t){v=!0,f=t}finally{try{!y&&x.return&&x.return()}finally{if(v)throw f}}}else r=r.concat(c);i++}}return this.lastBuckets=i,r}},{key:"queryCallbackAll",value:function(t,e,i){e=void 0===e||e;for(var r=0,a=[],n=this.getBounds(t),s=n.xStart,h=n.yStart,l=n.xEnd,o=n.yEnd,u=h;u<=o;u++)for(var c=s;c<=l;c++){var y=this.hash[c+","+u];if(y){if(e){var v=!0,f=!1,d=void 0;try{for(var x,b=y[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var p=x.value,g=p[this.AABB];g.x+g.width>t.x&&g.x<t.x+t.width&&g.y+g.height>t.y&&g.y<t.y+t.height&&(a.push(p),i(p))}}catch(t){f=!0,d=t}finally{try{!v&&b.return&&b.return()}finally{if(f)throw d}}}else{var a=a.concat(y),m=!0,f=!1,d=void 0;try{for(var B,S=y[Symbol.iterator]();!(m=(B=S.next()).done);m=!0)i(B.value)}catch(t){f=!0,d=t}finally{try{!m&&S.return&&S.return()}finally{if(f)throw d}}}r++}}return this.lastBuckets=r,a}},{key:"queryCallback",value:function(t,e,i){i=void 0===i||i;for(var r=this.getBounds(t),a=r.xStart,t=r.yStart,n=r.xEnd,s=r.yEnd,h=t;h<=s;h++)for(var l=a;l<=n;l++){var o=this.hash[l+","+h];if(o)for(var u=0;u<o.length;u++){var c=o[u];if(i){var y=c.AABB;if(y.x+y.width>y.x&&y.x<y.x+y.width&&y.y+y.height>y.y&&y.y<y.y+y.height&&e(c))return!0}else if(e(c))return!0}}return!1}},{key:"stats",value:function(){var t=0,e=0,i=!0,r=!1,a=void 0;try{for(var n,s=this.containers[Symbol.iterator]();!(i=(n=s.next()).done);i=!0)for(var h=n.value,l=0;l<h.children.length;l++)t+=h.children[l].visible?1:0,e++}catch(t){r=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw a}}return{total:e,visible:t,culled:e-t}}},{key:"getNumberOfBuckets",value:function(){return Object.keys(this.hash).length}},{key:"getAverageSize",value:function(){var t,e=0;for(t in this.hash)e+=this.hash[t].length;return e/this.getBuckets().length}},{key:"getLargest",value:function(){var t,e=0;for(t in this.hash)this.hash[t].length>e&&(e=this.hash[t].length);return e}},{key:"getWorldBounds",value:function(){var t,e=1/0,i=1/0,r=0,a=0;for(t in this.hash)var n=t.split(","),s=parseInt(n[0]),n=parseInt(n[1]),e=s<e?s:e,i=n<i?n:i,r=r<s?s:r,a=a<n?n:a;return{xStart:e,yStart:i,xEnd:r,yEnd:a}}},{key:"getSparseness",value:function(t){for(var e=0,i=0,r=t?this.getBounds(t):this.getWorldBounds(),a=r.xStart,t=r.yStart,n=r.xEnd,s=r.yEnd,h=t;h<s;h++)for(var l=a;l<n;l++)e+=this.hash[l+","+h]?1:0,i++;return e/i}}]),n);function n(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.xSize=(t=t||{}).xSize||t.size||1e3,this.ySize=t.ySize||t.size||1e3,this.AABB=t.type||"AABB",this.spatial=t.spatial||"spatial",this.calculatePIXI=void 0===t.calculatePIXI||t.calculatePIXI,this.visibleText=void 0===t.visibleTest||t.visibleTest,this.simpleTest=void 0===t.simpleTest||t.simpleTest,this.dirtyTest=void 0===t.dirtyTest||t.dirtyTest,this.visible=t.visible||"visible",this.dirty=t.dirty||"dirty",this.width=this.height=0,this.hash={},this.objects=[],this.containers=[]}e.exports=a},{}]},{},[1]);